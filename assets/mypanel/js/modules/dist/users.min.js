/*! 20-07-2017 */
$(document).ready(function(){function a(a){var b=$("#form-login").data("formValidation"),c=$("#form-login").find(".tab-pane").eq(a);b.validateContainer(c);var d=b.isValidContainer(c);return d===!1||null===d?!1:!0}$("#form-login").formValidation({framework:"bootstrap",trigger:"blur",verbose:!1,icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh glyphicon-spin"},fields:{username:{validators:{notEmpty:{message:lang.line("validation_required").replace("{0}",lang.line("users_nickname"))},stringLength:{min:6,max:15,message:lang.line("validation_between_length").replace("{0}",lang.line("users_nickname")).replace("{1}",6).replace("{2}",15)},regexp:{regexp:/^[a-z0-9\.]+$/,message:lang.line("validation_alpha_numeric_point")},remote:{async:!0,url:base_url("users/InputValidator"),type:"POST",data:csrf_form_base()}}},password:{enabled:!1,validators:{notEmpty:{message:lang.line("validation_required2").replace("{0}",lang.line("users_password"))},stringLength:{min:8,message:lang.line("validation_min_length").replace("{0}",lang.line("users_password")).replace("{1}",8)}}},confirm_password:{enabled:!1,validators:{notEmpty:{message:lang.line("validation_required2").replace("{0}",lang.line("users_confirmation_password"))},identical:{field:"password",message:lang.line("validation_password_identical")}}},first_name:{validators:{notEmpty:{message:lang.line("validation_required").replace("{0}",lang.line("common_first_name"))}}},last_name:{validators:{notEmpty:{message:lang.line("validation_required").replace("{0}",lang.line("common_last_name"))}}},email:{enabled:!1,validators:{emailAddress:{message:lang.line("validation_email_match")},stringLength:{max:512,message:lang.line("validation_max_length").replace("{0}",lang.line("common_email")).replace("{1}",512)},remote:{async:!0,url:base_url("users/InputValidator"),type:"POST",data:csrf_form_base()}}},"grants[]":{validators:{callback:{message:lang.line("validation_subpermission_required"),callback:function(){var a=$("#permission_list input").is(":checked");return $(".module").each(function(b,c){var d=$(c).parent(),e=$(c).is(":checked");$("ul",d).length>0&&a&&(a&=!e||e&&$("ul > li > input:checked",d).length>0)}),0===a&&(a=!1),a}}}}}}).on("err.validator.fv",function(a,b){if("username"===b.field&&"remote"===b.validator){var c=b.result.suggestions;c?b.fv.updateMessage("username","remote",lang.line("validation_in_use").replace("{0}",lang.line("users_nickname"))+"<br/>"+lang.line("validation_availables")+c.join(", ")):b.fv.updateMessage("username","remote",lang.line("validation_not_available").replace("{0}",lang.line("users_nickname")))}if("email"===b.field&&"remote"===b.validator){var d=b.result.not_valid;d?b.fv.updateMessage("email","remote",lang.line("validation_not_valid").replace("{0}",lang.line("common_email"))):b.fv.updateMessage("email","remote",lang.line("validation_in_use").replace("{0}",lang.line("common_email")))}}).on("keyup",'[name="password"]',function(){var a=""==$(this).val();$("#form-login").formValidation("enableFieldValidators","password",!a).formValidation("enableFieldValidators","confirm_password",!a);var b=$("#password-label").hasClass("required");$("#form-login").formValidation("enableFieldValidators","password",b),$(this).val().length>=1&&$("#form-login").formValidation("enableFieldValidators","password",!0);var c=$(this).val(),d=0,e=$("#passwordMeter").find(".progress-bar");switch(d+=c.length>=8?1:-1,/[A-Z]/.test(c)&&(d+=1),/[a-z]/.test(c)&&(d+=1),/[0-9]/.test(c)&&(d+=1),/[!#$%&^~*_]/.test(c)&&(d+=1),c.length<8?d=-1:d+=0,""===c&&(d=null),!0){case null===d:e.html("").css("width","0%").removeClass().addClass("progress-bar");break;case 0>=d:e.html(lang.line("validation_password_very_weak")).css("width","25%").removeClass().addClass("progress-bar progress-bar-danger");break;case d>0&&2>=d:e.html(lang.line("validation_password_weak")).css("width","50%").removeClass().addClass("progress-bar progress-bar-warning");break;case d>2&&4>=d:e.html(lang.line("validation_password_medium")).css("width","75%").removeClass().addClass("progress-bar progress-bar-info");break;case d>4:e.html(lang.line("validation_password_strong")).css("width","100%").removeClass().addClass("progress-bar progress-bar-success")}}).on("change",'[name="email"]',function(){var a=""==$(this).val();$("#form-login").formValidation("enableFieldValidators","email",!a)}).bootstrapWizard({tabClass:"nav nav-pills",onTabClick:function(){return!1},onNext:function(b,c,d){var e=c.find("li").length,f=d+1,g=a(d-1);return g?void(e>=f&&b.addClass("done")):!1},onTabShow:function(a,b,c){var d=b.find("li").length,e=c+1;e>=d?($("#form-login").find(".pager .next").hide(),$("#form-login").find(".pager .last").show().removeClass("disabled"),$("#outputNickname").text($("#username").val()),$("#outputName").text($("#first_name").val()+" "+$("#last_name").val()),""===$("#email").val()?($("#outputEmail").hide(),$("#outputlabel").hide()):($("#outputEmail").show(),$("#outputlabel").show(),$("#outputEmail").text($("#email").val()))):($("#form-login").find(".pager .next").show(),$("#form-login").find(".pager .last").hide()),a.removeClass("done")},onLast:function(){$("#form-login").ajaxSubmit({success:function(a){a.success?$(location).attr("href",base_url("users")):$.notify(a.message,"danger")},dataType:"json"})}});var b=$("#password-label").hasClass("required");$("#form-login").formValidation("enableFieldValidators","password",b),$("ul#permission_list > li > input[name='grants[]']").each(function(){var a=$(this);$("ul > li > input",a.parent()).each(function(){var b=$(this),c=function(a){b.prop("disabled",!a),!a&&b.prop("checked",!1)};a.change(function(){c(a.is(":checked"))}),c(a.is(":checked"))})})});